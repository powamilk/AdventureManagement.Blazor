@page "/adventures/detail/{Id:int}"
@using AdventureManagement.BUS.ViewModel.AdventureViewModel
@using AdventureManagement.BUS.Services.Interface
@using MudBlazor
@inject IAdventureService AdventureService
@inject NavigationManager Navigation

<MudContainer MaxWidth="MaxWidth.Medium" Class="d-flex justify-center">
    <MudPaper Class="p-4 m-4" Elevation="1" Style="width: 100%;">
        <MudText Typo="Typo.h6" GutterBottom="true">Thông Tin Adventure</MudText>

        @if (Adventure != null)
        {
            <MudGrid>
                <MudItem xs="4">
                    <strong>Tiêu đề:</strong>
                </MudItem>
                <MudItem xs="8">
                    @Adventure.Title
                </MudItem>

                <MudItem xs="4">
                    <strong>Mô tả:</strong>
                </MudItem>
                <MudItem xs="8">
                    @Adventure.Description
                </MudItem>

                <MudItem xs="4">
                    <strong>Địa điểm:</strong>
                </MudItem>
                <MudItem xs="8">
                    @Adventure.Location
                </MudItem>

                <MudItem xs="4">
                    <strong>Thời lượng (giờ):</strong>
                </MudItem>
                <MudItem xs="8">
                    @Adventure.Duration
                </MudItem>

                <MudItem xs="4">
                    <strong>Guide ID:</strong>
                </MudItem>
                <MudItem xs="8">
                    @Adventure.Guide?.Id
                </MudItem>

                <MudItem xs="4">
                    <strong>Danh sách Organisms:</strong>
                </MudItem>
                <MudItem xs="8">
                    @if (Adventure.Organisms != null && Adventure.Organisms.Any())
                    {
                        @foreach (var organism in Adventure.Organisms)
                        {
                            <MudChip T="string" Color="Color.Primary" Size="Size.Small">@organism.Name</MudChip>
                        }
                    }
                    else
                    {
                        <span>Không có Organisms nào</span>
                    }
                </MudItem>
            </MudGrid>

            <MudButton Color="Color.Secondary" Variant="Variant.Outlined" OnClick="GoBack" StartIcon="@Icons.Material.Filled.ArrowBack" Class="mt-4">
                Quay Lại
            </MudButton>
        }
        else
        {
            <MudText Typo="Typo.body1">Đang tải dữ liệu...</MudText>
        }
    </MudPaper>
</MudContainer>

@code {
    [Parameter] public int Id { get; set; }
    private AdventureVM Adventure { get; set; }

    protected override async Task OnInitializedAsync()
    {
        Adventure = await AdventureService.GetByIdAsync(Id);
        if (Adventure != null)
        {
            Console.WriteLine($"Title: {Adventure.Title}");
            Console.WriteLine($"Description: {Adventure.Description}");
            Console.WriteLine($"Location: {Adventure.Location}");
            Console.WriteLine($"Duration: {Adventure.Duration}");
            Console.WriteLine($"Guide ID: {Adventure.Guide?.Id}");
            Console.WriteLine($"Organisms: {string.Join(", ", Adventure.Organisms.Select(o => o.Name))}");
        }
        else
        {
            Console.WriteLine("Adventure is null");
        }
    }

    private void GoBack()
    {
        Navigation.NavigateTo("/adventure/list");
    }
}
